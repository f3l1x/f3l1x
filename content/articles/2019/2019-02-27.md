---
date: "2019-02-27"
title: "ZEIT Now: migrace .dev domÃ©ny do cloudu"
tags: ["zeit", "domain", "now", "cloud"]
slug: "zeit-now-migrace-dev-domeny-do-cloudu"
---

13 let jsem Äekal na sprÃ¡vnou domÃ©nu, a pak jsem ji rovnou hodil do cloudu.

<!--more-->

`<off-topic>`

Od doby, co Google oznÃ¡mil, Å¾e bude prodÃ¡vat domÃ©ny s koncovkou **.dev**, jsem se tÄ›Å¡il, Å¾e si udÄ›lÃ¡m radost.
ÄŒekal jsem, neÅ¾ se Google vyslovÃ­ a nechÃ¡ mi si tu domÃ©nu koupit. Ona takovÃ¡ domÃ©na `felix.dev` znÃ­ fakt cool.
Od pradÃ¡vna totiÅ¾ bojuju s tÃ­m, Å¾e mi mÅ¯j tÃ¡ta a jmenovec vyfouknul skoro vÅ¡echy pÄ›knÃ½ domÃ©ny a e-mailovÃ© ÃºÄty.
ChtÄ›l jsem mÃ­t e-mail `milansulc@gmail.com`, ale nebyl jsem oÄividnÄ› prvnÃ­.

TenkrÃ¡t, zhruba pÅ™ed 13 lety, jsem si tedy zaloÅ¾il e-mail `rkfelix@gmail.com`, RK znamenÃ¡ Rychnov nad KnÄ›Å¾nou. TenkrÃ¡t mi to nevadilo,
ale kdyÅ¾ ho nÄ›komu dnes diktuji, nenÃ­ to moc profesionÃ¡lnÃ­.

DomÃ©nu `milansulc.cz` jsem nakonec zÃ­skÃ¡l, ale za prvÃ© je dlouhÃ¡ a za druhÃ©, co zvolit jako prefix, `info@milansulc.cz`? `chci@milansulc.cz`? `dycky@milansulc.cz`?
To snad radÅ¡i ne. Tudy cesta taky nevede.

Pak jsem objevil koncovku `.xyz` asi za 1 $, ale uÅ¾ asi tuÅ¡Ã­te, proÄ je tak levnÃ¡...

NicmÃ©nÄ›, kdyÅ¾ se zaÄaly rozÅ¡iÅ™ovat koncovky `.io`, tak jsem znovu pÅ™isel pozdÄ›. Nakonec jsem si zaregistroval {hackerskou} domÃ©nu `f3l1x.io` (tady prÃ¡vÄ› jste),
ale jak poznamenal [Honza ÄŒernÃ½](https://twitter.com/chemix_cz) (chemix): â€S tÃ­m se nikdo vypisovat nebude.â€œ NuÅ¾e, doufÃ¡m, Å¾e backlinky odvedou svoji prÃ¡ci.

A koneÄnÄ› se dostÃ¡vÃ¡me do doby zhruba 2 tÃ½dny zpÄ›t, kdy si dÃ¡vÃ¡m do kupy seznam domÃ©n, co si koupÃ­m. PochopitelnÄ› `felix.dev` nechybÃ­, event v kalendÃ¡Å™i
na den, kdy Google uvolÅˆuje registrace bez navÃ½Å¡enÃ­ mÃ¡m, vÅ¡echno vypadÃ¡ slibnÄ›.

Dnes, **27.2.2019**, pravidelnÄ› kontroluju stav domÃ©n a co nevidÃ­m.
Moji, jako fakt, moji domÃ©nu `felix.dev` nÄ›kdo koupil. Dprdl. On si to fakt nÄ›kdo koupil v pÅ™edprodeji, za takovÃ½ prachy, kroutÃ­m hlavou.

<x-figure url="https://cdn.f3l1x.io/blog/2019/google-get-dev.png" title="Google .dev domain"></x-figure>

Moje zÃ¡loÅ¾nÃ­ domÃ©na `sulc.dev` je stÃ¡le volnÃ¡. Dnes stojÃ­ 12 $ + 125 $, asi na provoz Google serverÅ¯. Od zÃ­tra stojÃ­ jenom 12 $. SvolÃ¡vÃ¡m rodinnÃ½ snÄ›m.
VÅ¡ichni truchlÃ­ se mnou. BÄ›hem pÃ¡r minut mÃ¡me jasno, nebudeme vÃ¡hat a koupÃ­me si za 3000,- KÄ `sulc.dev`. ProtoÅ¾e pÅ™ece `milan@sulc.dev` je ultra cool. Right?

`</off-topic>`

----

PojÄme se podÃ­vat, co to ten [ZEIT](https://zeit.co/) je a s ÄÃ­m nÃ¡m mÅ¯Å¾e pomoci. Nutno dodat, Å¾e jsem si proÅ¡el pÅ™es Azure, AWS aÅ¾ ke GCP, ale ZEIT je pro mÄ› jasnej objev roku 2018.

Azure, AWS i GCP majÃ­ vlastnÃ­ HW/SW. Vy si mÅ¯Å¾ete koupit nÄ›jakou sluÅ¾bu nebo vÃ½kon a pÅ™es jejich admin nÃ¡stroje/konzole ho spravovat. ZEIT stojÃ­ bokem, resp.
nad tÄ›mito cloudy a pomocÃ­ svÃ©ho API je ovlÃ¡dÃ¡. Vy jen Å™Ã­kÃ¡te, Å¾e chcete nahrÃ¡t **nÄ›kam** svÅ¯j statickÃ½ obsah nebo tÅ™eba kus PHP/JS/Go/Python kÃ³du, ale uÅ¾ se nestarÃ¡te, jestli
je to realnÄ› hostovanÃ© u GCP nebo tÅ™eba u AWS. To za vÃ¡s Å™eÅ¡Ã­ ZEIT a Å™eÅ¡Ã­ to opravdu pÄ›knÄ›. TÃ­m myslÃ­m vÃ½vojÃ¡Å™sky, pÅ™es konzoli.

NejdÅ™Ã­ve nainstalujeme nÃ¡stroj `now`, jak [radÃ­ dokumentace](https://zeit.co/docs/v2/getting-started/installation/). VytvoÅ™Ã­me ÃºÄet, pÅ™ihlÃ¡sÃ­me, atd.

```
npm install -g now
now login
```

Takhle vypadÃ¡ `now -h`.

```sh
$ now -h

  ğš« now [options] <command | path>
  Commands:
    Cloud
      deploy               [path]      Performs a deployment (default)
      ls | list            [app]       Lists deployments
      rm | remove          [id]        Removes a deployment
      ln | alias           [id] [url]  Configures aliases for deployments
      inspect              [id]        Displays information related to a deployment
      domains              [name]      Manages your domain names
      certs                [cmd]       Manages your SSL certificates
      secrets              [name]      Manages your secret environment variables
      dns                  [name]      Manages your DNS records
      logs                 [url]       Displays the logs for a deployment
      scale                [args]      Scales the instance count of a deployment
      init                 [example]   Initialize an example project
      help                 [cmd]       Displays complete help for [cmd]
    Administrative
      billing | cc         [cmd]       Manages your credit cards and billing methods
      upgrade | downgrade  [plan]      Upgrades or downgrades your plan
      teams                [team]      Manages your teams
      switch               [scope]     Switches between teams and your personal account
      login                [email]     Logs into your account or creates a new one
      logout                           Logs out of your account
      whoami                           Displays the current scope
  Options:
    -h, --help                     Output usage information
    -v, --version                  Output the version number
    -V, --platform-version         Set the platform version to deploy to
    -n, --name                     Set the project name of the deployment
    -A FILE, --local-config=FILE   Path to the local `now.json` file
    -Q DIR, --global-config=DIR    Path to the global `.now` directory
    -d, --debug                    Debug mode [off]
    -f, --force                    Force a new deployment even if nothing has changed
    -t TOKEN, --token=TOKEN        Login token
    -p, --public                   Deployment is public (`/_src` is exposed)
    -e, --env                      Include an env var during run time (e.g.: `-e KEY=value`). Can appear many times.
    -b, --build-env                Similar to `--env` but for build time only.
    -m, --meta                     Add metadata for the deployment (e.g.: `-m KEY=value`). Can appear many times.
    -C, --no-clipboard             Do not attempt to copy URL to clipboard
    -T, --team                     Set a custom team scope
    --regions                      Set default regions to enable the deployment on
  > NOTE: To view the usage information for Now 1.0, run `now help deploy-v1`
  Examples:
  â€“ Deploy the current directory
    $ now
  â€“ Deploy a custom path
    $ now /usr/src/project
  â€“ Deploy with environment variables
    $ now -e NODE_ENV=production -e SECRET=@mysql-secret
  â€“ Show the usage information for the sub command `list`
    $ now help list
```

DomÃ©nu mÃ¡me, chceme ji pÅ™idat do sprÃ¡vy ZEIT. ProÄ?

<x-figure url="https://cdn.f3l1x.io/blog/2019/zeit-dns-speed.png" title="ZEIT DNS speed"></x-figure>

1. Bude hostovanÃ¡ na rychlÃ© infrastruktuÅ™e, kterou [ZEIT provozuje s CloudFlare](https://zeit.world).
2. DNS spravujete pÅ™es konzoli, ne admin rozhranÃ­, fakt pÅ™es terminÃ¡l, jako pravej geek.
3. ZEIT mÃ¡ velmi Å¡tÄ›drÃ½ free tarif, idealnÃ­ na prototypovÃ¡nÃ­ nebo vlastnÃ­ web.

<x-figure url="https://cdn.f3l1x.io/blog/2019/zeit-pricing.png" title="ZEIT pricing"></x-figure>

PÅ™idÃ¡me domÃ©nu pÅ™es terminÃ¡l.

```
$ now domains add sulc.dev
```

Å½e se vÅ¡e podaÅ™ilo, vÃ­te hned.

```
> Success! Domain sulc.dev added correctly. [3s]

> WARN! The domain was added but it is not verified. To verify it, you should either:
  a) Change your domain nameservers to the following intended set: [recommended]

     Intended Nameservers    Current Nameservers
     b.zeit-world.co.uk      dns1.registrar-servers.com    âœ˜
     d.zeit-world.org        dns2.registrar-servers.com    âœ˜
     e.zeit-world.net        -                             âœ˜
     f.zeit-world.com        -                             âœ˜

  b) Add a DNS TXT record with the name and value shown below.

     name        type        value
     _now        TXT         **HASH**

  We will run a verification for you and you will receive an email upon completion.
  If you want to force running a verification, you can run `now domains verify <domain>`
  Read more: https://err.sh/now-cli/domain-verification
```

Jak je vidÄ›t, ZEIT doporuÄuje zmÄ›nit NS na jejich servery, abyste domÃ©nu mohli pohodlnÄ› spravovat.
Lze nasmÄ›rovat i CNAME, ale doporuÄuju zmÄ›nit komplet NS, niÄemu to nevadÃ­.

Potom, co je domÃ©na pÅ™ipojena k vaÅ¡emu ÃºÄtu, se ÄekÃ¡ na verifikaci, kdy ZEIT ovÄ›Å™uje, Å¾e jste
sprÃ¡vnÄ› nastavili NS zÃ¡znamy.

<x-figure url="https://cdn.f3l1x.io/blog/2019/zeit-domains.png" title="ZEIT domains list"></x-figure>

Jakmile dojde k verifikaci, mÅ¯Å¾ete svoji domÃ©nu ovlÃ¡dat kompletnÄ› pÅ™es terminÃ¡l. NapÅ™. nastavit si MX zÃ¡znamy.

ZobrazÃ­me si nÃ¡povÄ›du pÅ™es `now help dns`.

```sh
$ now help dns

  ğš« now dns [options] <command>

  Commands:

    add     [details]             Add a new DNS entry (see below for examples)
    import  [domain] [zonefile]   Import a DNS zone file (see below for examples)
    rm      [id]                  Remove a DNS entry using its ID
    ls      [domain]              List all DNS entries for a domain

  Options:

    -h, --help                     Output usage information
    -A FILE, --local-config=FILE   Path to the local `now.json` file
    -Q DIR, --global-config=DIR    Path to the global `.now` directory
    -d, --debug                    Debug mode [off]
    -t TOKEN, --token=TOKEN        Login token
    -T, --team                     Set a custom team scope

  Examples:

  â€“ Add an A record for a subdomain

      $ now dns add <DOMAIN> <SUBDOMAIN> <A | AAAA | ALIAS | CNAME | TXT>  <VALUE>
      $ now dns add zeit.rocks api A 198.51.100.100

  â€“ Add an MX record (@ as a name refers to the domain)

      $ now dns add <DOMAIN> '@' MX <RECORD VALUE> <PRIORITY>
      $ now dns add zeit.rocks '@' MX mail.zeit.rocks 10

  â€“ Add an SRV record

      $ now dns add <DOMAIN> <NAME> SRV <PRIORITY> <WEIGHT> <PORT> <TARGET>
      $ now dns add zeit.rocks '@' SRV 10 0 389 zeit.party

  â€“ Add a CAA record

      $ now dns add <DOMAIN> <NAME> CAA '<FLAGS> <TAG> "<VALUE>"'
      $ now dns add zeit.rocks '@' CAA '0 issue "zeit.co"'

  â€“ Import a Zone file

      $ now dns import <DOMAIN> <FILE>
      $ now dns import zeit.rocks ./zonefile.txt
```

A pÅ™idÃ¡me MX zÃ¡znamy.

```
$ now dns add sulc.dev '@' MX mx1.example.com 10
> Success! DNS record for domain sulc.dev (rec_0123456789abcdefg1) created under f3l1x [1m]

$ now dns add sulc.dev '@' MX mx2.example.com 20
> Success! DNS record for domain sulc.dev (rec_0123456789abcdefg2) created under f3l1x [1m]
```

Takhle jednoduchÃ© to je. ZnÃ¡te ZEIT? PouÅ¾Ã­vÃ¡te ho na nÄ›co? PodÄ›lte se do diskuze.
